#![allow(
	unused_crate_dependencies,
	reason = "binary lives in xeno-registry package and relies on shared deps"
)]

use xeno_registry::{
	ACTIONS, COMMANDS, GUTTERS, HOOKS, MOTIONS, NOTIFICATIONS, STATUSLINE_SEGMENTS, TEXT_OBJECTS,
	RegistryMetadata,
};

fn print_registry<T: RegistryMetadata>(label: &str, items: &'static [T]) {
	let mut ids: Vec<&'static str> = items.iter().map(|item| item.id()).collect();
	ids.sort_unstable();

	println!("## {} ({})", label, ids.len());
	for id in ids {
		println!("- {}", id);
	}
	println!();
}

fn print_notifications(label: &str, items: &'static [xeno_registry::NotificationDef]) {
	let mut ids: Vec<&'static str> = items.iter().map(|item| item.id).collect();
	ids.sort_unstable();

	println!("## {} ({})", label, ids.len());
	for id in ids {
		println!("- {}", id);
	}
	println!();
}

fn main() {
	println!("# Registry Inventory");
	println!();
println!("Generated by `cargo run -p xeno-registry --bin registry_inventory`.");
	println!();

	print_registry("Actions", &ACTIONS);
	print_registry("Commands", &COMMANDS);
	print_registry("Motions", &MOTIONS);
	print_registry("Gutters", &GUTTERS);
	print_registry("Hooks", &HOOKS);
	print_registry("Statusline Segments", &STATUSLINE_SEGMENTS);
	print_registry("Text Objects", &TEXT_OBJECTS);
	print_registry("Options", &xeno_registry::options::OPTIONS);
	print_registry("Themes", &xeno_registry::themes::THEMES);
	print_notifications("Notifications", &NOTIFICATIONS);
}
